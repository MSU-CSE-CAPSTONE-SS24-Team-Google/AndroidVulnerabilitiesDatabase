<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R5KCC18HCL"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-R5KCC18HCL');
</script>



<div class = "container">
    <div #ContainerRef class="chart-container">
        <iframe width="1200" height="400" src="https://lookerstudio.google.com/embed/reporting/0fb0cda3-7806-440e-b010-9c701da361bd/page/kIV1C" frameborder="0" style="border:0" allowfullscreen sandbox="allow-storage-access-by-user-activation allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox"></iframe>
    </div>
    <section class="trending-vulnerabilities">
      <h1 class="title">Trending Vulnerabilities</h1>
      <div class="vulnerability-list">
        <div *ngFor="let cve of dataDict['fullPageUrl']; let i = index; " class="vulnerability-card" (click)="goToDetailsPage(cve)">
          <div class="card-content" [style.background-color]="calculateBackgroundColor(dataDict['screenPageViews'][i])">
            <h2 class="vulnerability-title">{{ cve }}</h2>
            <div class="severity-label"><strong>Views: {{ dataDict['screenPageViews'][i] }}</strong></div>
          </div>
        </div>
      </div>
    </section>
    <br>
    <div class="last-updated">
      Database last updated: <span id="last-updated-time"> {{ update_date }} </span>
    </div>
    <!-- vulnerability-list.component.html -->
    <h2>Newly Added Vulnerabilities</h2>
    <div class="vulnerability-list">
        
        <div *ngFor="let vulnerability of vulnerabilities" class="vulnerability-card" >
          <div (click)="goToDetailsPage(vulnerability.cve)">
            <mat-card  class="mat-elevation-z2" >
                <mat-card-header  [class.critical]="vulnerability.severity === 'Critical'" [class.high]="vulnerability.severity === 'High'" [class.moderate]="vulnerability.severity === 'Moderate'" [class.low]="vulnerability.severity === 'Low'">
                  <mat-card-title>{{ vulnerability.cve }}</mat-card-title>
                  <div class="severity-item" *ngIf="vulnerability.base_score != null">
                    <mat-progress-spinner
                    mode="determinate"
                    [value]="vulnerability.base_score * 10"
                    [color]="getSeverityColor(vulnerability.base_score)"
                    diameter="100"
                    strokeWidth="10"
                  ></mat-progress-spinner>
                  <div class="severity-label"><strong>{{ vulnerability.base_score }}</strong></div>
                  <div class="severity-label">Base Score</div>
                </div>
                </mat-card-header>
                
                <mat-card-content  [class.critical]="vulnerability.severity === 'Critical'" [class.high]="vulnerability.severity === 'High'" [class.moderate]="vulnerability.severity === 'Moderate'" [class.low]="vulnerability.severity === 'Low'">
                    <div class="vulnerability-info" >
                        <div class="label">Patch Level:</div>
                        <div class="value">{{ vulnerability.patch_level }}</div>
                        <div class="label">Severity:</div>
                        <div class="value">{{ vulnerability.severity }}</div>
                        <div class="label">Type:</div>
                        <div class="value">{{ vulnerability.type }}</div>
                        <div class="label">Refrences:</div>
                        <div class="value">{{ vulnerability.references_ }}</div>
                        <div class="label">Component:</div>
                        <div class="value">{{ vulnerability.component }}</div>
                    </div>
                </mat-card-content>
              </mat-card>
            </div>
    </div>
  </div>
    
</div>  

