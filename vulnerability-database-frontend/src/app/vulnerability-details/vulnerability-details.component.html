<!-- 
   This the HTML code that shows all of the vulnerbailities from the custom query search 
   Author: Trey Cosnowski, Alex Bocchi
 -->

<div class="container">
    <div class="vulnerability-details-container" [class.critical]="vulnerabilityDetails.severity == 'Critical'" [class.high]="vulnerabilityDetails.severity == 'High'" [class.medium]="vulnerabilityDetails.severity == 'Medium'" [class.low]="vulnerabilityDetails.severity === 'Low'">
        <h2>{{ vulnerabilityDetails.cve }}</h2>
      
        <div class="severity-container" *ngIf="vulnerabilityDetails.base_score != null; else NoBaseScore">
          <div class="severity-item">
            <mat-progress-spinner
              mode="determinate"
              [value]="vulnerabilityDetails.base_score * 10"
              [color]="getSeverityColor(vulnerabilityDetails.base_score)"
              diameter="100"
              strokeWidth="10"
            ></mat-progress-spinner>
            <div class="severity-label"><strong>{{ vulnerabilityDetails.base_score }}</strong></div>
            <div class="severity-label">Base Score</div>
          </div>
          <div class="severity-item">
            <mat-progress-spinner
              mode="determinate"
              [value]="vulnerabilityDetails.exploitability_score * 10"
              [color]="getSeverityColor(vulnerabilityDetails.exploitability_score)"
              diameter="100"
              strokeWidth="10"
            ></mat-progress-spinner>
            <div class="severity-label"><strong>{{ vulnerabilityDetails.exploitability_score }}</strong></div>
            <div class="severity-label">Exploitability Score</div>
          </div>
          <div class="severity-item">
            <mat-progress-spinner
              mode="determinate"
              [value]="vulnerabilityDetails.impact_score * 10"
              [color]="getSeverityColor(vulnerabilityDetails.impact_score)"
              diameter="100"
              strokeWidth="10"
            ></mat-progress-spinner>
            <div class="severity-label"><strong>{{ vulnerabilityDetails.impact_score }}</strong></div>
            <div class="severity-label">Impact Score</div>
          </div>
          
      
          <!-- Add similar sections for other severity scores if needed -->
      
        </div>
        <div>
        <ng-template #NoBaseScore><h2 >Vulnerability is {{badCve}}</h2></ng-template>
        </div>
      
        <div class="details-section">
            <h3>Additional Information</h3>
            <ul>
              <li *ngIf="vulnerabilityDetails.patch_level !== 'None' && vulnerabilityDetails.patch_level !== null"><strong>Patch Level:</strong> {{ vulnerabilityDetails.patch_level }}</li>
              <li *ngIf="vulnerabilityDetails.cve !== 'None' && vulnerabilityDetails.cve !== null"><strong>CVE:</strong> {{ vulnerabilityDetails.cve }}</li>
              <li *ngIf="vulnerabilityDetails.references_ !== 'None' && vulnerabilityDetails.reference_links !== 'None'"><strong>References:</strong> <a href="{{ vulnerabilityDetails.reference_links }}"> {{ vulnerabilityDetails.references_ }}</a></li>
              <li *ngIf="vulnerabilityDetails.references_ !== 'None' && vulnerabilityDetails.reference_links == 'None'"><strong>References:</strong> {{ vulnerabilityDetails.references_ }} </li>
              <li *ngIf="vulnerabilityDetails.type !== 'None' && vulnerabilityDetails.type !== null"><strong>Type:</strong> {{ vulnerabilityDetails.type }}</li>
              <li *ngIf="vulnerabilityDetails.severity !== 'None' && vulnerabilityDetails.severity !== null"><strong>Severity:</strong> {{ vulnerabilityDetails.severity }}</li>
              <li *ngIf="vulnerabilityDetails.updated_aosp_versions !== 'None' && vulnerabilityDetails.updated_aosp_versions !== null"><strong>Updated AOSP Versions:</strong> {{ vulnerabilityDetails.updated_aosp_versions }}</li>
              <li *ngIf="vulnerabilityDetails.component !== 'None' && vulnerabilityDetails.component !== null"><strong>Component:</strong> {{ vulnerabilityDetails.component }}</li>
              <li *ngIf="vulnerabilityDetails.subcomponent !== 'None' && vulnerabilityDetails.subcomponent !== null"><strong>Subcomponent:</strong> {{ vulnerabilityDetails.subcomponent }}</li>
              <li *ngIf="vulnerabilityDetails.android_launch_version !== 'None' && vulnerabilityDetails.android_launch_version !== null"><strong>Android Launch Version:</strong> {{ vulnerabilityDetails.android_launch_version }}</li>
              <li *ngIf="vulnerabilityDetails.kernel_launch_version !== 'None' && vulnerabilityDetails.kernel_launch_version !== null"><strong>Kernel Launch Version:</strong> {{ vulnerabilityDetails.kernel_launch_version }}</li>
              <li *ngIf="vulnerabilityDetails.minimum_launch_version !== 'None' && vulnerabilityDetails.minimum_launch_version !== null"><strong>Minimum Launch Version:</strong> {{ vulnerabilityDetails.minimum_launch_version }}</li>
              <li *ngIf="vulnerabilityDetails.minimum_kernel_version !== 'None' && vulnerabilityDetails.minimum_kernel_version !== null"><strong>Minimum Kernel Version:</strong> {{ vulnerabilityDetails.minimum_kernel_version }}</li>
              <li *ngIf="vulnerabilityDetails.date_reported !== 'None' && vulnerabilityDetails.date_reported !== null"><strong>Date Reported:</strong> {{ vulnerabilityDetails.date_reported }}</li>
              <li *ngIf="vulnerabilityDetails.updated_google_devices !== 'None' && vulnerabilityDetails.updated_google_devices !== null"><strong>Updated Google Devices:</strong> {{ vulnerabilityDetails.updated_google_devices }}</li>
              <li *ngIf="vulnerabilityDetails.updated_nexus_devices !== 'None' && vulnerabilityDetails.updated_nexus_devices !== null"><strong>Updated Nexus Devices:</strong> {{ vulnerabilityDetails.updated_nexus_devices }}</li>
              <li *ngIf="vulnerabilityDetails.updated_versions !== 'None' && vulnerabilityDetails.updated_versions !== null"><strong>Updated Versions:</strong> {{ vulnerabilityDetails.updated_versions }}</li>
              <li *ngIf="vulnerabilityDetails.affected_versions !== 'None' && vulnerabilityDetails.affected_versions !== null"><strong>Affected Versions:</strong> {{ vulnerabilityDetails.affected_versions }}</li>
              <li *ngIf="vulnerabilityDetails.asb_url !== 'None'"><strong>ASB URL:</strong><a href="{{asb_url}}{{vulnerabilityDetails.asb_url}}"> {{asb_url}}{{vulnerabilityDetails.asb_url}}</a></li>
              
              <ul *ngIf="vulnerabilityDetails.component_code !== 'None' && vulnerabilityDetails.component_code_link !== 'None'" class="component"><strong class="componentCodeText">Component Code(s):</strong>
                <li *ngFor="let component of componentCodeLinkDict | keyvalue" class="componentLi"><a href="{{component.value}}"> {{component.key}}</a></li>
              </ul>

              <ul *ngIf="vulnerabilityDetails.component_code !== 'None' && vulnerabilityDetails.component_code_link === 'None'" class="component"><strong class="componentCodeText">Component Code(s):</strong>
                <li *ngFor="let component of componentCodeArray" class="componentLi">{{component}}</li>
              </ul>

              <li *ngIf="vulnerabilityDetails.date !== 'None' && vulnerabilityDetails.date !== null"><strong>Date:</strong> {{ vulnerabilityDetails.date }}</li>
              <li *ngIf="vulnerabilityDetails.metric_version !== 'None' && vulnerabilityDetails.metric_version !== null"><strong>Metric Version:</strong> {{ vulnerabilityDetails.metric_version }}</li>
              <li *ngIf="vulnerabilityDetails.publicly_available !== 'None' && vulnerabilityDetails.publicly_available !== null"><strong>Publically Available:</strong> {{ vulnerabilityDetails.publicly_available }}</li>
              <li *ngIf="vulnerabilityDetails.vuln_status !== 'None' && vulnerabilityDetails.vuln_status !== null"><strong>Status:</strong> {{ vulnerabilityDetails.vuln_status }}</li>
              <li *ngIf="vulnerabilityDetails.type !== 'None' && vulnerabilityDetails.type !== null"><strong>Type:</strong> {{ vulnerabilityDetails.type }}</li>
              <li *ngIf="vulnerabilityDetails.note !== 'None' && vulnerabilityDetails.note !== null"><strong>Vulnerability Notes:</strong> {{ vulnerabilityDetails.type }}</li>
            </ul>
          </div>
      
        <!-- Add additional sections for other vulnerability details as needed -->
      
      </div>
</div>
