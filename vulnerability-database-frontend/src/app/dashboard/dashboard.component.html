<div class = "container">
    <h1>Android Vulnerability Database Dashboard</h1>

    <!--create the charts in a container for more control over the sizing-->
    <div class = "chartcontainer">
        <canvas #sevChart
            baseChart 
            [datasets]="SeverityData.datasets"
            [labels]="SeverityData.labels"
            [type]="'doughnut'"
            [options] = "SeverityOptions"
            
            >
        </canvas>

        <canvas #bsChart baseChart 
            [datasets]="CVSSData.datasets"
            [labels]="CVSSData.labels"
            [type]="'doughnut'"
            [options] = "CVSSOptions"
            >
        </canvas>
    </div>

    <table>
        <thead>
            <tr>
                <th>CVE Ids</th>
                <th>Device Scope</th>
                <th>Patch Level</th>
                <th>Reference Number</th>
                <th>Vulnerability Type or Component</th>
                <th>Severity</th>
                <th>Base Score</th>
                <th>Updated AOSP Versions or subcomponent</th>
                <!-- Add more columns as needed -->
            </tr>
        </thead>
        <tbody>
            <!--enter the data into the cells of the table-->
            <tr *ngFor = "let item of currentTablePage()">
                <td><a href="javascript:void(0)" (click)="goToDetails(item.cve)">{{ item.cve }}</a></td>
                <td>{{item.bulletin_type}}</td>
                <td>{{ item.patch_level }}</td>
                <td>
                    <!--When there are reference links, link the reference, otherwise, do not link it-->
                    <ng-container *ngIf = "item.reference_links != 'None'; else noLinks">
                        <ng-container *ngFor="let reference of item.references_.split(' ')">
                            <a href="javascript:void(0)" (click)="referenceLinks(item.references_, reference)">{{ reference }}</a><br>
                        </ng-container>
                    </ng-container> 
                    <ng-template #noLinks>{{item.references_}}</ng-template>
                </td>
                <ng-container *ngIf = "item.type != 'None'; else showComponent">
                    <td>{{ item.type }}</td>
                </ng-container>
                <ng-template #showComponent>
                    <td>{{ item.component}}</td>
                </ng-template>
                
                <td>{{ item.severity }}</td>
                <!--Declare variable noBase if there is no base score-->
                <td>
                    <ng-container *ngIf = "item.base_score !== null; else noBase">
                        {{item.base_score}}
                    </ng-container>
                    <!--when noBase is not null then we just display this message in the table-->
                    <ng-template #noBase>
                        Awaiting Analysis
                    </ng-template>
                </td>
                <ng-container *ngIf = "item.updated_aosp_versions !== 'None'; else showSubcomponent">
                    <td>{{ item.updated_aosp_versions }}</td>
                </ng-container>

                <ng-template #showSubcomponent>
                    <td>{{item.subcomponent}}</td>
                </ng-template>
                
                
            </tr>
        </tbody>
    </table>
    <!--pagination of the table-->
    <div *ngIf="asbData.results.length > 10">
        <button mat-icon-button (click)="prevPage()" [disabled]="!hasPrevPage()"><mat-icon>keyboard_arrow_left</mat-icon></button>
        <button mat-icon-button (click)="nextPage()" [disabled]="!hasNextPage()"><mat-icon>keyboard_arrow_right</mat-icon></button>
      </div>
      <p>Page {{currentPage + 1}} of {{totalPages}}</p>
</div>